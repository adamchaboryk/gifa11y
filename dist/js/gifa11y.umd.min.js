/*! Gifa11y 2.0.3 | @author Adam Chaboryk Â© 2021 - 2024 | @license MIT | @contact adam@chaboryk.xyz | https://github.com/adamchaboryk/gifa11y */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Gifa11y=e()}(this,(function(){"use strict";class t extends HTMLElement{constructor(){super(),this.option=window.gifa11yOption}connectedCallback(){const t=this.attachShadow({mode:"open"}),e=document.createElement("style");e.innerHTML=`\n      :host{--gifa11y-font:system-ui,"Segoe UI",roboto,helvetica,arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}*,:after,:before{box-sizing:border-box}button{align-items:center;box-shadow:0 0 16px 0 rgba(0,0,0,.31);cursor:pointer;display:flex;justify-content:center;line-height:normal;margin:12px;min-height:36px;min-width:36px;padding:4px;position:absolute;text-align:center;transition:all .2s ease-in-out;z-index:500}button:before{content:"";inset:-8.5px;min-height:50px;min-width:50px;position:absolute}button:focus{outline:3px solid transparent}.v1{border-radius:50%}.v2{align-content:center;align-items:center;border-radius:5px;display:flex;flex-wrap:wrap;justify-content:center;text-align:center}.v2:after{content:"GIF";display:inline-block;font-family:var(--gifa11y-font);font-weight:600;line-height:0;padding-left:3px;padding-right:3px}i{padding:4px}i,svg{vertical-align:middle}svg{display:block;flex-shrink:0;position:relative}\n      button {\n        background: ${this.option.buttonBackground};\n        border: ${this.option.buttonBorder};\n        color: ${this.option.buttonIconColor};\n      }\n      button:hover, button:focus {\n        background: ${this.option.buttonBackgroundHover};\n      }\n      button:focus {\n        box-shadow: 0 0 0 5px ${this.option.buttonFocusColor};\n      }\n      i {\n        font-size: ${this.option.buttonIconFontSize};\n        min-width: calc(${this.option.buttonIconFontSize} * 1.4);\n        min-height: calc(${this.option.buttonIconFontSize} * 1.4);\n      }\n      svg {\n        height: ${this.option.buttonIconSize};\n        width: ${this.option.buttonIconSize};\n      }\n      button:after {\n        font-size: ${this.option.buttonIconFontSize};\n      }\n      .warning, .warning:hover {\n        border-radius: 5px;\n        background: #cf0000;\n        color: white;\n      }\n      .warning:after {\n        content: '${this.option.langAltWarning}';\n        padding: 5px;\n      }`,t.appendChild(e)}}function e(t,e){const n=document.getElementById("gifa11y-all"),a=window.matchMedia("(prefers-reduced-motion: reduce)"),i=document.querySelector("html");if(null!==n){!a||a.matches||!0===e.initiallyPaused?(i.setAttribute("data-gifa11y-all","paused"),n.innerText=e.langPlayAllButton):(i.setAttribute("data-gifa11y-all","playing"),n.innerText=e.langPauseAllButton),n.setAttribute("disabled",!0);const o=t.filter((t=>!t.complete)).map((t=>new Promise((e=>{const n=t;n.onload=e,n.onerror=e}))));Promise.all(o).then((()=>{n.addEventListener("click",(()=>{const a="paused"===i.getAttribute("data-gifa11y-all")?"playing":"paused";let o,l,s,r;i.setAttribute("data-gifa11y-all",a),"paused"===i.getAttribute("data-gifa11y-all")?(o="block",l="none",s="paused",r=e.langPlay,n.innerText=e.langPlayAllButton):(o="none",l="block",s="playing",r=e.langPause,n.innerText=e.langPauseAllButton),t.forEach((t=>{t.setAttribute("style",`display: ${l}`)})),document.querySelectorAll("[data-gifa11y-canvas]").forEach((t=>{t.setAttribute("style",`display: ${o}`)})),document.querySelectorAll("gifa11y-button").forEach((t=>{const e=t.shadowRoot.querySelector("button"),n=e.getAttribute("data-gifa11y-alt"),a=e.querySelector(".play"),i=e.querySelector(".pause");a.style.display=o,i.style.display=l,e.setAttribute("data-gifa11y-state",s),e.setAttribute("aria-label",`${r} ${n}`)}))})),n.removeAttribute("disabled")}))}}return class{constructor(n){const a={buttonBackground:"#072c7c",buttonBackgroundHover:"#0a2051",buttonBorder:"2px solid #fff",buttonIconColor:"white",buttonFocusColor:"#00e7ffad",buttonIconSize:"1.5rem",buttonIconFontSize:"1rem",buttonPlayIconID:"",buttonPauseIconID:"",buttonPlayIconHTML:"",buttonPauseIconHTML:"",container:"body",exclusions:"",gifa11yOff:"",inheritClasses:!0,initiallyPaused:!1,langPause:"Pause GIF:",langPlay:"Play GIF:",langPauseAllButton:"Pause all GIFs",langPlayAllButton:"Play all GIFs",langMissingAlt:"Missing image description.",langAltWarning:"Error! Please add alt text to GIF.",missingAltWarning:!0,showButtons:!0,showGifText:!1,target:"",...n};window.gifa11yOption=a;const i=[];this.initialize=()=>{(()=>{const{gifa11yOff:t}=a;return t.trim().length>0&&document.querySelector(t)})()||(customElements.define("gifa11y-button",t),document.addEventListener("DOMContentLoaded",(()=>{!function(t,e){const n=document.querySelector(e.container),a=n||document.querySelector("body"),i=e.target?`, ${e.target}`:"",o=e.exclusions?`, ${e.exclusions}`:"";Array.from(a.querySelectorAll(`:is(img[src$=".gif"]${i}):not([src*="gifa11y-ignore"], .gifa11y-ignore${o})`)).forEach((e=>{t.push(e)}))}(i,a),i.forEach((t=>{const e=()=>{!function(t,e){const n=t,a=document.createElement("canvas");a.setAttribute("role","image"),a.setAttribute("aria-label",n.alt),a.setAttribute("data-gifa11y-canvas","");const{width:i}=n,{height:o}=n;if(a.width=i,a.height=n.naturalHeight/n.naturalWidth*i+.5,a.hidden=!1,n.parentNode.insertBefore(a,n),a.getContext("2d").drawImage(n,0,0,i,o),n.after(a),!0===e.inheritClasses){let t=n.getAttribute("class");t||(t=""),a.setAttribute("class",t)}let l=n.getAttribute("alt");null!==l&&""!==l&&" "!==l||(l=e.langMissingAlt);const s=window.matchMedia("(prefers-reduced-motion: reduce)");!s||s.matches||n.classList.contains("gifa11y-paused")||n.src.indexOf("gifa11y-paused")>-1||!0===e.initiallyPaused?(n.style.display="none",n.setAttribute("data-gifa11y-state","paused")):(a.style.display="none",n.setAttribute("data-gifa11y-state","playing"))}(t,a),!0===a.showButtons&&function(t,e){const n=t,a=window.matchMedia("(prefers-reduced-motion: reduce)"),i=n.nextElementSibling;let o,l,s,r;const u=n.src;!a||a.matches||n.classList.contains("gifa11y-paused")||u.indexOf("gifa11y-paused")>-1||!0===e.initiallyPaused?(o=e.langPlay,r="block",s="none",l="paused"):(o=e.langPause,r="none",s="block",l="playing");const c=document.createElement("button");let d=n.getAttribute("alt");null!==d&&""!==d&&" "!==d||(d=e.langMissingAlt,!0===e.missingAltWarning&&c.classList.add("warning")),c.setAttribute("aria-label",`${o} ${d}`),c.setAttribute("data-gifa11y-state",l),c.setAttribute("data-gifa11y-alt",d),c.innerHTML=`\n  <div class="pause" aria-hidden="true" style="display:${s}"></div>\n  <div class="play" aria-hidden="true" style="display:${r}"></div>`;const g=c.querySelector(".pause"),y=c.querySelector(".play");if(!1===e.showGifText?c.classList.add("v1"):c.classList.add("v2"),e.buttonPauseIconID.length){const t=document.getElementById(e.buttonPauseIconID).innerHTML;g.innerHTML=t}else e.buttonPauseIconHTML.length?g.innerHTML=e.buttonPauseIconHTML:g.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16"><path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"/></svg>';if(e.buttonPlayIconID.length){const t=document.getElementById(e.buttonPlayIconID).innerHTML;y.innerHTML=t}else e.buttonPlayIconHTML.length?y.innerHTML=e.buttonPlayIconHTML:y.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16"><path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg>';let p=n.closest("a, button")||n;const b=document.createElement("gifa11y-button");p.insertAdjacentElement("beforebegin",b),b.shadowRoot.appendChild(c),c.addEventListener("click",(t=>{const a="paused"===c.getAttribute("data-gifa11y-state")?"playing":"paused";c.setAttribute("data-gifa11y-state",a);const o=c.querySelector(".play"),l=c.querySelector(".pause");"paused"===c.getAttribute("data-gifa11y-state")?(n.style.display="none",i.style.display="block",o.style.display="block",l.style.display="none",c.setAttribute("aria-label",`${e.langPlay} ${d}`)):(n.style.display="block",i.style.display="none",o.style.display="none",l.style.display="block",c.setAttribute("aria-label",`${e.langPause} ${d}`)),t.preventDefault()}),!1)}(t,a)};t.complete?e():t.addEventListener("load",e)})),e(i,a)}),!1))},this.initialize()}}}));
