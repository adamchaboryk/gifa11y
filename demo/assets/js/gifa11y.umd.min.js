/*! Gifa11y 2.0.0 | @author Adam Chaboryk Â© 2021 - 2023 | @license MIT | @contact adam@chaboryk.xyz | https://github.com/adamchaboryk/gifa11y */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Gifa11y=e()}(this,(function(){"use strict";function t(t,e){const n=document.getElementById("gifa11y-all"),a=window.matchMedia("(prefers-reduced-motion: reduce)"),i=document.querySelector("html");if(null!==n){!a||a.matches||!0===e.initiallyPaused?(i.setAttribute("data-gifa11y-all","paused"),n.innerText=e.langPlayAllButton):(i.setAttribute("data-gifa11y-all","playing"),n.innerText=e.langPauseAllButton),n.setAttribute("disabled",!0);const o=t.filter((t=>!t.complete)).map((t=>new Promise((e=>{const n=t;n.onload=e,n.onerror=e}))));Promise.all(o).then((()=>{n.addEventListener("click",(()=>{const a="paused"===i.getAttribute("data-gifa11y-all")?"playing":"paused";let o,l,s,r;i.setAttribute("data-gifa11y-all",a),"paused"===i.getAttribute("data-gifa11y-all")?(o="block",l="none",s="paused",r=e.langPlay,n.innerText=e.langPlayAllButton):(o="none",l="block",s="playing",r=e.langPause,n.innerText=e.langPauseAllButton),t.forEach((t=>{t.setAttribute("style",`display: ${l}`)})),document.querySelectorAll("[data-gifa11y-canvas]").forEach((t=>{t.setAttribute("style",`display: ${o}`)})),document.querySelectorAll("button.gifa11y-btn").forEach((t=>{const e=t.getAttribute("data-gifa11y-alt"),n=t.querySelector(".gifa11y-play-icon"),a=t.querySelector(".gifa11y-pause-icon");n.style.display=o,a.style.display=l,t.setAttribute("data-gifa11y-state",s),t.setAttribute("aria-label",`${r} ${e}`)}))})),n.removeAttribute("disabled")}))}}return class{constructor(e){const n={buttonBackground:"indigo",buttonBackgroundHover:"rebeccapurple",buttonIconColor:"white",buttonFocusColor:"#00e7ffad",buttonIconSize:"1.5rem",buttonIconFontSize:"1rem",buttonPlayIconID:"",buttonPauseIconID:"",buttonPlayIconHTML:"",buttonPauseIconHTML:"",container:"body",exclusions:"",gifa11yOff:"",inheritClasses:!0,initiallyPaused:!1,langPause:"Pause GIF:",langPlay:"Play GIF:",langPauseAllButton:"Pause all GIFs",langPlayAllButton:"Play all GIFs",langMissingAlt:"Missing image description.",langAltWarning:"&#9888; Error! Please add alternative text to GIF.",missingAltWarning:!0,showButtons:!0,showGifText:!1,target:"",...e},a=[];this.initialize=()=>{(()=>{const{gifa11yOff:t}=n;return t.trim().length>0&&document.querySelector(t)})()||document.addEventListener("DOMContentLoaded",(()=>{!function(t,e){const n=document.querySelector(e.container),a=n||document.querySelector("body"),i=e.target?`, ${e.target}`:"",o=e.exclusions?`, ${e.exclusions}`:"";Array.from(a.querySelectorAll(`:is(img[src$=".gif"]${i}):not([src*="gifa11y-ignore"], .gifa11y-ignore${o})`)).forEach((e=>{t.push(e)}))}(a,n),a.length&&function(t){const e=document.createElement("style");e.innerHTML=`\n  :root{--gifa11y-font:system-ui,"Segoe UI",roboto,helvetica,arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}button.gifa11y-btn,button.gifa11y-btn:after,button.gifa11y-btn:before{all:unset;box-sizing:border-box}button.gifa11y-btn{border:2px solid #fff;box-shadow:0 0 16px 0 rgba(0,0,0,.31);cursor:pointer;display:block;line-height:normal;margin:12px;min-height:36px;min-width:36px;padding:4px;position:absolute;text-align:center;transition:all .2s ease-in-out;z-index:500}button.gifa11y-btn.gifa11y-v1{border-radius:50%!important}button.gifa11y-btn.gifa11y-v2{align-content:center;align-items:center;border-radius:5px;display:flex;flex-wrap:wrap;justify-content:center;text-align:center}button.gifa11y-btn.gifa11y-v2:after{content:"GIF";display:inline-block;font-family:var(--gifa11y-font);font-weight:600;line-height:0;padding-left:3px;padding-right:3px}button.gifa11y-btn:before{content:"";inset:-8.5px;min-height:50px;min-width:50px;position:absolute}button.gifa11y-btn:focus{outline:3px solid transparent}button.gifa11y-btn>i{padding:4px;vertical-align:middle}button.gifa11y-btn>svg{flex-shrink:0;position:relative;vertical-align:middle}div.gifa11y-warning{background:#8b0000;color:#fff;font-family:var(--gifa11y-font);font-size:18px;line-height:normal;margin:0;padding:8px}\n  button.gifa11y-btn {\n    background: ${t.buttonBackground};\n    color: ${t.buttonIconColor};\n  }\n  button.gifa11y-btn:hover, button.gifa11y-btn:focus {\n    background: ${t.buttonBackgroundHover};\n  }\n  button.gifa11y-btn:focus {\n    box-shadow: 0 0 0 5px ${t.buttonFocusColor};\n  }\n  .gifa11y-play-icon i,\n  .gifa11y-pause-icon i {\n    font-size: ${t.buttonIconFontSize};\n    min-width: calc(${t.buttonIconFontSize} * 1.4);\n    min-height: calc(${t.buttonIconFontSize} * 1.4);\n  }\n  .gifa11y-pause-icon > svg,\n  .gifa11y-play-icon > svg {\n    height: ${t.buttonIconSize};\n    width: ${t.buttonIconSize};\n  }\n  button.gifa11y-btn::after {\n    font-size: ${t.buttonIconFontSize};\n  }`,document.head.appendChild(e)}(n),a.forEach((t=>{const e=()=>{!function(t,e){const n=t,a=document.createElement("canvas");a.setAttribute("role","image"),a.setAttribute("aria-label",n.alt),a.setAttribute("data-gifa11y-canvas","");const{width:i}=n,{height:o}=n;if(a.width=i,a.height=n.naturalHeight/n.naturalWidth*i+.5,a.hidden=!1,n.parentNode.insertBefore(a,n),a.getContext("2d").drawImage(n,0,0,i,o),n.after(a),!0===e.inheritClasses){let t=n.getAttribute("class");t||(t=""),a.setAttribute("class",t)}let l=n.getAttribute("alt");null!==l&&""!==l&&" "!==l||(l=e.langMissingAlt);const s=window.matchMedia("(prefers-reduced-motion: reduce)");!s||s.matches||n.classList.contains("gifa11y-paused")||n.src.indexOf("gifa11y-paused")>-1||!0===e.initiallyPaused?(n.style.display="none",n.setAttribute("data-gifa11y-state","paused")):(a.style.display="none",n.setAttribute("data-gifa11y-state","playing"))}(t,n),!0===n.showButtons&&function(t,e){const n=t,a=window.matchMedia("(prefers-reduced-motion: reduce)"),i=n.nextElementSibling;let o,l,s,r;const u=n.src;!a||a.matches||n.classList.contains("gifa11y-paused")||u.indexOf("gifa11y-paused")>-1||!0===e.initiallyPaused?(o=e.langPlay,r="block",s="none",l="paused"):(o=e.langPause,r="none",s="block",l="playing");let c=n.getAttribute("alt");if((null===c||""===c||" "===c)&&(c=e.langMissingAlt,!0===e.missingAltWarning)){const t=document.createElement("div");t.classList.add("gifa11y-warning"),t.innerHTML=e.langAltWarning,i.after(t)}const d=document.createElement("button");d.classList.add("gifa11y-btn"),d.setAttribute("aria-label",`${o} ${c}`),d.setAttribute("data-gifa11y-state",l),d.setAttribute("data-gifa11y-alt",c),d.innerHTML=`\n  <div class="gifa11y-pause-icon" aria-hidden="true" style="display:${s}"></div>\n  <div class="gifa11y-play-icon" aria-hidden="true" style="display:${r}"></div>`;const g=d.querySelector(".gifa11y-pause-icon"),y=d.querySelector(".gifa11y-play-icon");if(!1===e.showGifText?d.classList.add("gifa11y-v1"):d.classList.add("gifa11y-v2"),e.buttonPauseIconID.length>1){const t=document.getElementById(e.buttonPauseIconID).innerHTML;g.innerHTML=t}else e.buttonPauseIconHTML.length>1?g.innerHTML=e.buttonPauseIconHTML:g.innerHTML='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16"><path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"/></svg>';if(e.buttonPlayIconID.length>1){const t=document.getElementById(e.buttonPlayIconID).innerHTML;y.innerHTML=t}else e.buttonPlayIconHTML.length>1?y.innerHTML=e.buttonPlayIconHTML:y.innerHTML='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16"><path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg>';let f=n.closest("a, button");f||(f=n),f.insertAdjacentElement("beforebegin",d),d.addEventListener("click",(t=>{const a="paused"===d.getAttribute("data-gifa11y-state")?"playing":"paused";d.setAttribute("data-gifa11y-state",a);const o=d.querySelector(".gifa11y-play-icon"),l=d.querySelector(".gifa11y-pause-icon");"paused"===d.getAttribute("data-gifa11y-state")?(n.style.display="none",i.style.display="block",o.style.display="block",l.style.display="none",d.setAttribute("aria-label",`${e.langPlay} ${c}`)):(n.style.display="block",i.style.display="none",o.style.display="none",l.style.display="block",d.setAttribute("aria-label",`${e.langPause} ${c}`)),t.preventDefault()}),!1)}(t,n)};t.complete?e():t.addEventListener("load",e)})),t(a,n)}),!1)},this.initialize()}}}));
